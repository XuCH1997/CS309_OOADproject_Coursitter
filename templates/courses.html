<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7 "> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie10 lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie10 lt-ie9"> <![endif]-->
<!--[if IE 9]>
<html class="no-js lt-ie10"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>

    <!-- Basic Page Needs -->
    <meta charset="utf-8">
    <title>Courses</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- Favicons -->
    <link rel="shortcut icon" href="../static/content/toy/images/img.ico">

    <!-- FONTS -->
    <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Roboto:100,300,400,400italic,700'>
    <link rel='stylesheet' href='http://fonts.googleapis.com/css?family=Patua+One:100,300,400,400italic,700'>
    <link rel='stylesheet'
          href='http://fonts.googleapis.com/css?family=Roboto:400,400italic,600,600italic,700,700italic'>
    <link rel='stylesheet'
          href='http://fonts.googleapis.com/css?family=Crimson+Text:400,400italic,600,600italic,700,700italic'>

    <!-- CSS -->
    <link rel='stylesheet' href='../static/css/global.css'>
    <link rel='stylesheet' href='../static/css/structure.css'>
    <link rel='stylesheet' href='../static/css/dentist.css'>
    <!--<link rel='stylesheet' href='custom.css'>-->

</head>

<body class="style-simple layout-full-width mobile-tb-left no-content-padding header-creative header-open minimalist-header sticky-white subheader-both-center menuo-no-borders footer-copy-center" onload="onloadTable()">
<div id="Header_creative">
    <a href="#" class="creative-menu-toggle"><i class="icon-menu"></i></a>
    <!--Social info area-->
    <ul class="social creative-social"></ul>
    <div class="creative-wrapper">
        <!-- Header -  Logo and Menu area -->
        <div id="Top_bar">
            <div class="one">
                <div class="top_bar_left">
                    <!-- Logo-->
                    <div class="logo">
                        <a id="logo" href="#" title="SUSTech"><img class="scale-with-grid" src="../static/content/toy/images/sustech.png" alt="SUSTech"/></a>
                    </div>
                    <!-- Main menu-->
                    <div class="menu_wrapper">
                        <nav id="menu" class="menu-main-menu-container">
                            <ul id="menu-main-menu" class="menu">
                                
                                <li class="current_page_item">
                                    <a href="#"><span>Courses</span></a>
                                </li>
                                <li>
                                    <a href="myself"><span>Myself</span></a>
                                </li>
                                <li>
                                    <a href="http:about"><span>About</span></a>
                                </li>
								<li>
                                    <a href="/"><span>Exit</span></a>
                                </li>
                            </ul>
                        </nav>
                        <a class="responsive-menu-toggle" href="#"><i class="icon-menu"></i></a>
                    </div>
                    <!-- Header Searchform area-->
                    <div class="search_wrapper">
                        <form method="get" id="searchform" action="#">

                            <input type="text" class="field" name="s" id="s" placeholder="Enter your search"/>
                            <input type="submit" class="submit flv_disp_none" value=""/>
                        </form>
                    </div>
                </div>
                <!-- Banner area - only for certain pages-->
                <div class="banner_wrapper"></div>
            </div>
        </div>
        <!-- Header Top -  Info Area -->
        <div id="Action_bar">
            <!--Social info area-->
            <ul class="social"></ul>
        </div>
    </div>
</div>


<!-- Main Theme Wrapper -->
<div id="Wrapper">
    <!-- Header Wrapper -->
    <div id="Header_wrapper">
        <!-- Header -->
        <header id="Header"></header>
        <!--Subheader area - only for certain pages -->
        <div id="Subheader">
            <div class="container">
                <div class="column one">
                    <h1 class="title">Courses</h1>
                </div>
            </div>
        </div>
    </div>
</div>


<table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td>开课单位:</td>
        <td>
            <select id="xx0301id" name="xx0301id">
                <option value="">--请选择--</option>

                <option value="8N6HtIeUIX">[001]通识与学科基础部</option>

                <option value="007">[007]网络通识课程部</option>
            </select>
        </td>
    </tr>
    <tr>
        <td>课程号:</td>
        <td><input type="text" id="kch" name="kch" value=""/></td>
    </tr>
    <tr>
        <td>课程名称:</td>
        <td><input type="text" id="kcmc" name="kcmc" value=""/></td>
    </tr>
</table>





<table width="100%" border="0" cellspacing="0" cellpadding="0" class="Nsb_r_list Nsb_table">
    <tr>
        <th class="Nsb_r_list_thb" scope="col">编号</th>
        <th class="Nsb_r_list_thb" scope="col">名称</th>
        <th class="Nsb_r_list_thb" scope="col">容量</th>
        <th class="Nsb_r_list_thb" scope="col">学时</th>
        <th class="Nsb_r_list_thb" scope="col">院系</th>
        <th class="Nsb_r_list_thb" scope="col">时间</th>
        <th class="Nsb_r_list_thb" scope="col">学分</th>
        <th class="Nsb_r_list_thb" scope="col">已选人数</th>
        <th class="Nsb_r_list_thb" scope="col">老师</th>
        <th class="Nsb_r_list_thb" scope="col">地点</th>
        <th class="Nsb_r_list_thb" scope="col">操作</th>
        <!--     <th class="Nsb_r_list_thb"  scope="col">课程类别</th>
            <th class="Nsb_r_list_thb"  scope="col">课程性质</th>
            <th class="Nsb_r_list_thb"  scope="col">课程属性</th>-->
        <!-- <th class="Nsb_r_list_thb" scope="col">状态</th>
         -->
    </tr>

    <tbody id="tbody_all_courses" style="display: none;">
    <tr>
        <td style="">MA301</td>
        <td style="">实变函数</td>
        <td style="">100</td>
        <td style="">48</td>
        <td style="">数学系</td>
        <td style="">1,3,5</td>
        <td style="">3</td>
        <td style="">48</td>
        <td style="">buzhidao</td>
        <td style="">liyuan</td>
        <!--     <td style="">理论课（不含实践）</td>
      <td style="">专业核心课</td>
      <td style="">选修</td>-->
        <td>
            <a href="#" onclick="pick_withdraw(this);">选课</a>
        </td>
    </tr>
    </tbody>

    <tr>
        <td colspan="16">未查询到数据</td>
    </tr>

</table>






<script type="text/javascript">
    function onloadTable()
    {
        var url = "http://119.23.233.0:5000/all_class"
        var json_obj = JSON.parse(Get(url));
        // var info = JSON.stringify(json_obj);
        // var data = eval('(' + info + ')');
        // alert(data.district);
        // alert(json_obj[0][1]);
        // alert(json_obj.length);

        var i;
        for(i = 0; i < json_obj.length; i++)
        {
            var v0 = json_obj[i][0];
            var v1 = json_obj[i][1];
            var v2 = json_obj[i][2];
            var v3 = json_obj[i][3];
            var v4 = json_obj[i][4];
            var v5 = json_obj[i][5];
            var v6 = json_obj[i][6];
            var v7 = json_obj[i][7];
            var v8 = json_obj[i][8];
            var v9 = json_obj[i][9];
            addRow(v0,v1,v2,v3,v4,v5,v6,v7,v8,v9);
        }
    }

    function Get(yourUrl)
    {
      var Httpreq = new XMLHttpRequest(); // a new request
      Httpreq.open("GET",yourUrl,false);
      Httpreq.send(null);
      // window.alert(Httpreq.responseText);
      return Httpreq.responseText;
    }

    function addRow(v0,v1,v2,v3,v4,v5,v6,v7,v8,v9)
    {
        let bodyObj = document.getElementById("tbody_all_courses");
        if(bodyObj === null)
        {
            alert("Body of Table not Exist!");
            return;
        }
        let rowCount = bodyObj.rows.length;
        bodyObj.style.display = ""; // display the tbody
        let cellCount = bodyObj.rows[0].cells.length;
        let newRow = bodyObj.insertRow(rowCount++);
        newRow.setAttribute('id',"tr" + rowCount.toString());
        newRow.insertCell(0).innerHTML = v0;
        newRow.insertCell(1).innerHTML = v1;
        newRow.insertCell(2).innerHTML = v2;
        newRow.insertCell(3).innerHTML = v3;
        newRow.insertCell(4).innerHTML = v4;
        newRow.insertCell(5).innerHTML = v5;
        newRow.insertCell(6).innerHTML = v6;
        newRow.insertCell(7).innerHTML = v7;
        newRow.insertCell(8).innerHTML = v8;
        newRow.insertCell(9).innerHTML = v9;
        let last_cell = newRow.insertCell(10);
        last_cell.innerHTML = bodyObj.rows[0].cells[cellCount - 1].innerHTML;
        last_cell.setAttribute('id',newRow.rowIndex);
        // alert(last_cell.getAttribute('id').toString());
        bodyObj.rows[0].style.display = "none"; // hide the first row
        // alert("new_row" + newRow.innerHTML);
    }

    function pick_withdraw(content)
    {
        // alert("---------------" + content.innerHTML);
        // alert(content.parentElement.innerHTML + "------------");
        if(content.innerHTML === "选课")
        {
            var table_row = content.parentElement.parentElement;
            var course_id = table_row.cells[0].innerHTML;
            var url = "http://119.23.233.0:5000/" + "pick/" + course_id;
            var result = Get(url);
            if(result === "success")
            {
                alert("选课 success!");
                content.innerHTML = "退课";
            }
            else
            {
                alert("选课失败:" + result);
            }
        }
        else if(content.innerHTML === "退课")
        {
            var table_row = content.parentElement.parentElement;
            var course_id = table_row.cells[0].innerHTML;
            var url = "http://119.23.233.0:5000/" + "withdraw/" + course_id;
            // alert("退课url-----" + url);
            var result = Get(url);
            
            alert("退课success!");
            content.innerHTML = "选课";
        }
        else
        {
            alert('errrrrrrrrrrrrrrrrrrrrrrrrrrrrrror' + content.innerHTML);
        }
    }
</script>









<!-- JS -->
<script src="../static/js/jquery-2.1.4.min.js"></script>

<script src="../static/js/mfn.menu.js"></script>
<script src="../static/js/jquery.plugins.js"></script>
<script src="../static/js/jquery.jplayer.min.js"></script>
<script src="../static/js/animations/animations.js"></script>
<script src="../static/js/scripts.js"></script>

<script>
    jQuery(window).load(function () {
        var retina = window.devicePixelRatio > 1 ? true : false;
        if (retina) {
            var retinaEl = jQuery("#logo img.logo-main");
            var retinaLogoW = retinaEl.width();
            var retinaLogoH = retinaEl.height();
            retinaEl.attr("src", "images/retina-dentist.png").width(retinaLogoW).height(retinaLogoH);
            var stickyEl = jQuery("#logo img.logo-sticky");
            var stickyLogoW = stickyEl.width();
            var stickyLogoH = stickyEl.height();
            stickyEl.attr("src", "images/retina-dentist.png").width(stickyLogoW).height(stickyLogoH);
        }
    });
</script>

</body>

</html>